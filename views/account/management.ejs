<h1><%= title %></h1>

<% if (typeof messages === "function") { 
  const flashHtml = messages();
  if (flashHtml) { %>
    <div class="flash-message">
      <%- flashHtml %>
    </div>
<%  } 
} %>

<main id="account-management">
  <section class="account-panel">
    <h2>
      Welcome <%= accountData && accountData.account_firstname 
        ? accountData.account_firstname 
        : "New" %>
    </h2>

    <p class="login-notice">You're logged in.</p>

    <!-- Update Account Information link (for ALL account types) -->
    <p>
      <a href="/account/update/<%= accountData.account_id %>" class="account-edit-link">
        Update Account Information
      </a>
    </p>

    <!-- Only show this block if Employee or Admin -->
    <% if (
      accountData 
      && (accountData.account_type === 'Employee' || accountData.account_type === 'Admin')
    ) { %>
      <h3>Inventory Management</h3>
      <p>
        <a href="/inv/">Go to Inventory Management</a>
      </p>
    <% } %>
  </section>
  <section class="client-reviews">
  <h2>Your Reviews</h2>

  <% if (!clientReviews || clientReviews.length === 0) { %>
    <p>You havenâ€™t written any reviews yet.</p>
  <% } else { %>
    <ul class="client-review-list">
      <% clientReviews.forEach(r => { %>
        <li>
          <p>
            <strong><%= r.inv_make %> <%= r.inv_model %></strong><br>
            <span><%= new Date(r.review_date).toLocaleDateString() %></span>
          </p>
          <p><%= r.review_text %></p>
          <div class="review-actions">
            <a href="/review/edit/<%= r.review_id %>">Edit</a>
            |
            <a href="/review/delete/<%= r.review_id %>">Delete</a>
          </div>

          
        </li>
      <% }) %>
    </ul>
  <% } %>
</section>
</main>